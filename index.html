<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BUKHARIYA EDUCATIONAL CENTRE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
    font-family: Arial, sans-serif;
    background:#eef2ef;
    margin:0;
    padding:20px;
}
.card{
    background:#fff;
    max-width:1100px;
    margin:auto;
    border-radius:20px;
    padding:25px;
    box-shadow:0 10px 30px rgba(0,0,0,.15);
}
h1{
    color:#0b5e3b;
    text-align:center;
    margin-bottom:5px;
}
h2{
    color:#4f63ff;
    text-align:center;
    margin-top:0;
}
#datetime{
    text-align:center;
    margin-bottom:20px;
}
input{
    width:100%;
    padding:14px;
    font-size:18px;
    border-radius:10px;
    border:2px solid #0b5e3b;
}
button{
    width:100%;
    padding:14px;
    font-size:18px;
    margin-top:12px;
    border:none;
    border-radius:10px;
    background:#0b5e3b;
    color:#fff;
    cursor:pointer;
}
button:hover{opacity:.9}
#error{
    color:red;
    text-align:center;
    margin-top:10px;
}
table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}
th,td{
    border:1px solid #ccc;
    padding:6px;
    text-align:center;
    font-size:13px;
}
th{
    background:#0b5e3b;
    color:#fff;
}
.actions{
    display:flex;
    gap:10px;
    margin-top:15px;
}
.actions button{
    width:33%;
}
</style>
</head>

<body>

<div class="card">
<h1>BUKHARIYA EDUCATIONAL CENTRE</h1>
<h2>ONLINE STUDENTS ATTENDANCE REPORT</h2>
<div id="datetime"></div>

<input id="adno" placeholder="Enter Admission Number (Eg: BL11)">
<button onclick="searchStudent()">Search</button>
<div id="error"></div>

<div id="result"></div>

<div class="actions" id="actions" style="display:none">
<button onclick="window.print()">Download PDF</button>
<button onclick="location.reload()">New Search</button>
<button onclick="sendWhatsApp()">Send WhatsApp</button>
</div>
</div>

<script>
const SHEET_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQQ-J8IvPnoIA-P1fbBemXE7tXLuT6_kODQamLC6xUUe2nnhAbRZ4zL2W13GNTm8rUQQrz2DpxNuoFB/pub?output=tsv";

function updateTime(){
    document.getElementById("datetime").innerText =
        new Date().toLocaleString();
}
setInterval(updateTime,1000); updateTime();

async function searchStudent(){
    const ad = document.getElementById("adno").value.trim().toUpperCase();
    document.getElementById("error").innerText="";
    document.getElementById("result").innerHTML="";
    document.getElementById("actions").style.display="none";

    const res = await fetch(SHEET_URL);
    const text = await res.text();
    const rows = text.split("\n").map(r=>r.split("\t"));

    for(let i=1;i<rows.length;i++){
        if(rows[i][1].toUpperCase()===ad){
            showData(rows[i]);
            return;
        }
    }
    document.getElementById("error").innerText="Admission number not found";
}

function showData(r){
    let html=`<table>
    <tr><th>Admission No</th><td>${r[1]}</td></tr>
    <tr><th>Name</th><td>${r[2]}</td></tr>
    <tr><th>Performance</th><td>${r[3]}</td></tr>
    </table><br><table><tr>`;

    for(let d=1;d<=31;d++) html+=`<th>${d}</th>`;
    html+="<th>Total</th><th>Remarks</th></tr><tr>";

    for(let i=4;i<=34;i++) html+=`<td>${r[i]}</td>`;
    html+=`<td>${r[35]}</td><td>${r[36]}</td></tr></table>`;

    document.getElementById("result").innerHTML=html;
    document.getElementById("actions").style.display="flex";
}

function sendWhatsApp(){
    const text = document.getElementById("result").innerText;
    window.open("https://wa.me/?text="+encodeURIComponent(text));
}
</script>

</body>
</html>
